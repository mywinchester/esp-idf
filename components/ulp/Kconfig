menu "超低功耗 (ULP) 协处理器"
    depends on (SOC_ULP_SUPPORTED || SOC_RISCV_COPROC_SUPPORTED || SOC_LP_CORE_SUPPORTED)

    config ULP_COPROC_ENABLED
        bool "启用超低功耗 (ULP) 协处理器"
        default "n"
        help
            如果您计划使用 ULP 协处理器，请启用此功能。
            一旦启用此选项，菜单中将出现更多 ULP 协处理器配置选项。

    choice ULP_COPROC_TYPE
        prompt "ULP 协处理器类型"
        depends on ULP_COPROC_ENABLED
        default ULP_COPROC_TYPE_RISCV if (IDF_TARGET_ESP32S2 || IDF_TARGET_ESP32S3)
        help
            选择 ULP 协处理器类型：ULP FSM（有限状态机）或 ULP RISC-V。

        config ULP_COPROC_TYPE_FSM
            bool "ULP FSM（有限状态机）"
            depends on SOC_ULP_FSM_SUPPORTED
        config ULP_COPROC_TYPE_RISCV
            bool "ULP RISC-V"
            depends on SOC_RISCV_COPROC_SUPPORTED
        config ULP_COPROC_TYPE_LP_CORE
            bool "LP 核心 RISC-V"
            depends on SOC_LP_CORE_SUPPORTED
    endchoice

    config ULP_COPROC_RESERVE_MEM
        int
        prompt "为协处理器保留的 RTC 慢速内存"
        depends on ULP_COPROC_ENABLED
        default 512 if IDF_TARGET_ESP32
        default 4096 if !IDF_TARGET_ESP32
        range 32 8176 if IDF_TARGET_ESP32 || IDF_TARGET_ESP32S2 || IDF_TARGET_ESP32S3
        range 32 16352 if IDF_TARGET_ESP32C5 || IDF_TARGET_ESP32C6
        range 32 31088 if IDF_TARGET_ESP32P4 # Some memory are reserved for ROM/RTC reserved
        help
            为 ULP 协处理器固件和数据保留的内存字节数。
            数据保留在 RTC 慢速内存的开始处。


    menu "ULP RISC-V 设置"
        depends on ULP_COPROC_TYPE_RISCV

        config ULP_RISCV_INTERRUPT_ENABLE
            bool
            prompt "启用 ULP RISC-V 中断"
            default "n"
            help
                打开此设置以启用 ULP RISC-V 核心的中断。

        config ULP_RISCV_UART_BAUDRATE
            int
            prompt "位带 ULP RISC-V UART 驱动程序使用的波特率"
            default 9600
            help
                位带 UART 驱动程序的精度有限，不建议将值增加到 19200 以上。

        config ULP_RISCV_I2C_RW_TIMEOUT
            int
            prompt "设置 ULP RISC-V I2C 事务超时（以刻度为单位）。"
            default 500
            range -1 4294967295
            help
                设置 ULP RISC-V I2C 读/写超时。将此值设置为 -1，
                如果 ULP RISC-V I2C 读取和写入 API 应永远等待。
                请注意，ULP 协处理器的刻度率将与主核心的操作系统
                刻度率不同，因此可能会有不同的超时值，具体取决于
                在哪个核心上调用 API。
    endmenu

    config ULP_SHARED_MEM
        depends on ULP_COPROC_TYPE_LP_CORE
        hex
        default 0x10
        help
            在 ulp_lp_core_memory_shared.c 中定义的共享内存的大小。
            大小应与那里定义的结构体的大小保持同步。

    config ULP_ROM_PRINT_ENABLE
        depends on ULP_COPROC_TYPE_LP_CORE && ESP_ROM_HAS_LP_ROM
        bool
        prompt "启用来自 LP ROM 的打印实用程序"
        default "y"
        help
            设置此选项以启用来自 LP ROM 的 printf 功能。此选项
            可以通过不链接来自 RAM 代码的 printf 功能来帮助减少 LP 核心二进制大小。
            注意：为了使 LP ROM 打印正常工作，请确保 LP 核心从 LP ROM 启动。

    menu "ULP 调试选项"
        config ULP_PANIC_OUTPUT_ENABLE
            depends on ULP_COPROC_TYPE_LP_CORE && SOC_ULP_LP_UART_SUPPORTED
            bool
            prompt "启用通过 LP UART 输出的紧急处理程序"
            default "y" if IDF_TARGET_ESP32P4
            help
                设置此选项以启用紧急处理程序功能。如果启用此选项，
                则 LP 核心将通过 LP UART 输出紧急转储，类似于主核心的操作。
                输出取决于 LP UART 已经初始化和配置。
                禁用此选项将通过不链接紧急处理程序功能来减少 LP 核心二进制大小。

        config ULP_HP_UART_CONSOLE_PRINT
            depends on ULP_COPROC_TYPE_LP_CORE
            bool
            prompt "将 lp_core_printf 路由到控制台 HP-UART"
            help
                设置此选项以将 lp_core_printf 路由到控制台 HP-UART。
                这允许您轻松查看来自 LP 核心的打印输出，而无需
                连接到 LP-UART。此选项有以下限制：

                1. HP 核心和 LP 核心访问 HP-UART 之间没有互斥，
                这意味着如果两个核心都在大量记录，输出字符串可能会混在一起。
                2. HP-UART 只能在 HP 核心运行时工作，这意味着如果
                HP 核心处于深度睡眠状态，LP 核心将无法打印到控制台 HP-UART。

                由于这些限制，建议仅将此选项用于简单调试。
                对于更严肃的用例，您应该使用 LP-UART。
    endmenu

endmenu  # Ultra Low Power (ULP) Co-processor
